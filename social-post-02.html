<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Post 02 â€” MDM Social Review</title>
<link rel="stylesheet" href="social-style.css">
<style>
body { padding-top: 92px; padding-bottom: env(safe-area-inset-bottom, 120px); }
</style>
</head>
<body>

<!-- NAV -->
<nav class="site-nav">
  <a href="social-index.html" class="nav-brand">
    <div class="nav-monogram">MDM</div>
    <span class="nav-title">Social Review</span>
  </a>
  <div class="nav-right">
    <span class="live-dot" id="live-indicator">â€¦</span>
    <a href="social-index.html" class="nav-back">â† All Posts</a>
    <div class="nav-progress">
      <span class="nav-pill approved" id="pill-approved">0 âœ“</span>
      <span class="nav-pill needs"    id="pill-needs">0 âš </span>
      <span class="nav-pill rejected" id="pill-rejected">0 âœ•</span>
    </div>
  </div>
</nav>

<!-- PORTAL SWITCHER -->
<div class="portal-switcher">
  <a href="index.html"        class="portal-switch-link">ğŸ“ Blog Review</a>
  <a href="social-index.html" class="portal-switch-link active">ğŸ“² Social Review</a>
</div>

<!-- PAGE HEADER -->
<div class="page-header">
  <div class="phi">
    <div class="post-meta-row">
      <span class="post-num-badge">Post 02 of 2</span>
      <span class="plat-badge-lg">ğŸ“² Instagram + Facebook</span>
    </div>
    <div class="post-date-display" id="date-display">TBD at TBD</div>
    <div class="post-time-sub">Scheduled</div>
    <div style="margin-top:14px;">
      <span class="status-badge pending" id="status-badge"><span class="badge-text">Pending Review</span></span>
      <span class="live-sync-badge" style="margin-left:14px;">Live Sync</span>
    </div>
  </div>
</div>
<div class="gold-rule"></div>

<!-- SPLIT: PHONE PREVIEW + EDIT PANEL -->
<div class="split-layout">

  <!-- LEFT: PHONE -->
  <div class="preview-col">
    <p class="preview-label">Live Preview</p>
    <div class="phone-frame">
      <div class="phone-notch"></div>
      <div class="phone-screen">
        <div class="ig-post">
          <div class="ig-header">
            <div class="ig-avatar"></div>
            <div>
              <div class="ig-username">mdmdesignstudio</div>
              <div class="ig-sub">Sponsored</div>
            </div>
            <div class="ig-dot">Â·Â·Â·</div>
          </div>
          <!-- Media: shows actual photo -->
          <div class="ig-media" id="preview-media">
            <img src="post-02-photo.jpg" alt="Round pedestal dining table in a lakefront setting with scenic water views." style="width:100%;height:100%;object-fit:cover;">
          </div>
          <div class="ig-actions">
            <span class="ig-action-icon">â™¡</span>
            <span class="ig-action-icon">ğŸ’¬</span>
            <span class="ig-action-icon">â†—</span>
            <span class="ig-save-icon">ğŸ”–</span>
          </div>
          <div class="ig-caption-block">
            <span class="ig-caption-user">mdmdesignstudio </span><span class="ig-caption-text" id="preview-caption">Lake views and good company. ğŸŒŠ Our round pedestal table takes lakefront living to new heightsâ€”designed to weather the elements while elevating every sunset gathering. Indoor style, outdoor durability.</span>
          </div>
          <div class="ig-location" id="preview-location"></div>
          <div class="ig-hashtags" id="preview-hashtags">#MDMDesignStudio #OutdoorTable #RoundTable #LakehouseStyle #PedestalTable #OutdoorLiving #PatioFurniture #LakesideLiving #CustomOutdoor #AlFresco</div>
          <div class="ig-tags"     id="preview-tags"><span class="ig-tag">@mdmdesignstudio</span></div>
          <div class="ig-timestamp">TBD Â· TBD</div>
          <div class="plat-tabs">
            <div class="ptab active">Instagram</div>
            <div class="ptab active">Facebook</div>
          </div>
        </div>
      </div>
    </div>
    <p style="font-size:11px;color:var(--dim);margin-top:10px;font-style:italic;">Preview updates as you type â†“</p>
  </div>

  <!-- RIGHT: EDIT PANEL -->
  <div class="edit-col">

    <!-- Reviewer name (top, always visible) -->
    <div class="field-row" style="margin-bottom:20px;">
      <label class="field-label">Your Name <span style="color:var(--dim);font-weight:300;">(for notes &amp; version history)</span></label>
      <input class="comment-name-input" type="text" id="commenter-name" placeholder="e.g. Sarah, MDM Teamâ€¦">
    </div>

    <!-- Editor toolbar -->
    <div class="editor-bar">
      <div class="editor-bar-left">
        <span class="editor-label">Post Details</span>
        <span class="editor-mode-badge" id="edit-mode-badge">Read Only</span>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;">
        <button class="editor-btn"         id="edit-toggle-btn"  onclick="toggleEditor()">âœ Edit</button>
        <button class="editor-btn primary"  id="edit-save-btn"   style="display:none;" onclick="saveEdit(2)">â†‘ Save Version</button>
        <button class="editor-btn danger"   id="edit-cancel-btn" style="display:none;" onclick="cancelEdit(2)">âœ• Cancel</button>
      </div>
    </div>

    <!-- MEDIA -->
    <div class="fields-section">
      <div class="fields-section-title">Media</div>
      <div class="field-row">
        <label class="field-label">Post Type</label>
        <select class="social-field" id="field-mediaType" disabled onchange="syncPreview()">
          <option value="photo" selected>Single Photo</option>
<option value="carousel">Carousel (multiple photos)</option>
<option value="reel">Reel / Video</option>
<option value="video">Video</option>
        </select>
      </div>
      <div class="field-row">
        <label class="field-label">Replace Photo / Add Video</label>
        <div class="media-drop-zone" id="media-slot-1"
             ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)"
             ondrop="handleMediaDrop(event,'media-slot-1')">
          <div class="drop-icon">ğŸ“</div>
          <div class="drop-label">Drop new photo or video</div>
          <div class="drop-hint">JPG, PNG, MP4 Â· replaces current image in preview</div>
          <input type="file" accept="image/*,video/*" onchange="handleMediaDrop(event,'media-slot-1')" disabled>
        </div>
      </div>
      <div class="field-row">
        <label class="field-label">Alt Text (Accessibility)</label>
        <textarea class="social-field" id="field-altText" disabled rows="2"
          oninput="onFieldInput(2)"
          placeholder="Describe the image for screen readersâ€¦">Round pedestal dining table in a lakefront setting with scenic water views.</textarea>
      </div>
    </div>

    <!-- CAPTION -->
    <div class="fields-section">
      <div class="fields-section-title">Caption</div>
      <div class="field-row">
        <label class="field-label">Caption</label>
        <textarea class="social-field caption-field" id="field-caption" disabled
          oninput="onFieldInput(2);updateCharCount(this,'cap-count',2200)"
          placeholder="Write your captionâ€¦">Lake views and good company. ğŸŒŠ Our round pedestal table takes lakefront living to new heightsâ€”designed to weather the elements while elevating every sunset gathering. Indoor style, outdoor durability.</textarea>
        <div class="char-count" id="cap-count">200 / 2,200</div>
      </div>
    </div>

    <!-- POST DETAILS -->
    <div class="fields-section">
      <div class="fields-section-title">Post Details</div>
      <div class="field-row">
        <label class="field-label">Location Tag</label>
        <input class="social-field" type="text" id="field-location" disabled
          oninput="onFieldInput(2)" placeholder="e.g. Birmingham, Alabama"
          value="">
      </div>
      <div class="field-row">
        <label class="field-label">Account Tags <span style="color:var(--dim);font-weight:300;">(comma separated)</span></label>
        <input class="social-field" type="text" id="field-tags" disabled
          oninput="onFieldInput(2)" placeholder="@mdmdesignstudio, @thecreatorie"
          value="@mdmdesignstudio">
      </div>
      <div class="field-row">
        <label class="field-label">Hashtags</label>
        <textarea class="social-field" id="field-hashtags" disabled rows="3"
          oninput="onFieldInput(2);updateHashCount(this,'hash-count')"
          placeholder="#CustomFurniture #Woodworkingâ€¦">#MDMDesignStudio #OutdoorTable #RoundTable #LakehouseStyle #PedestalTable #OutdoorLiving #PatioFurniture #LakesideLiving #CustomOutdoor #AlFresco</textarea>
        <div class="char-count" id="hash-count">10 / 30 tags</div>
        <p class="field-hint"># added automatically if missing.</p>
      </div>
    </div>

    <!-- SCHEDULING -->
    <div class="fields-section">
      <div class="fields-section-title">Scheduling</div>
      <div class="datetime-row">
        <div class="field-row">
          <label class="field-label">Date</label>
          <input class="social-field" type="text" id="field-postDate" disabled
            oninput="onFieldInput(2);syncDateDisplay()"
            placeholder="e.g. March 2, 2026" value="TBD">
        </div>
        <div class="field-row">
          <label class="field-label">Time (CT)</label>
          <input class="social-field" type="time" id="field-postTime" disabled
            oninput="onFieldInput(2);syncDateDisplay()" value="09:00">
        </div>
      </div>
    </div>

  </div><!-- /edit-col -->
</div><!-- /split-layout -->

<!-- DISCUSSION -->
<div class="discussion-outer">
  <div class="discussion-header">
    <div>
      <div class="discussion-title">Discussion</div>
      <div style="font-size:12px;color:var(--muted);font-weight:300;margin-top:3px;">Notes visible to everyone Â· sync live</div>
    </div>
    <span class="live-dot connected" id="disc-live">Live</span>
  </div>
  <div class="comment-form">
    <input class="comment-name-input" type="text" id="comment-name-sync" placeholder="Your nameâ€¦">
    <textarea class="comment-textarea" id="comment-text" placeholder="Add feedback, questions, or notes about this postâ€¦"></textarea>
    <button class="comment-submit" onclick="submitCommentLocal(2)">Post Note</button>
  </div>
  <div class="comments-list" id="comments-list">
    <p class="no-comments" id="no-comments-msg">No notes yet. Be the first.</p>
  </div>
</div>

<!-- VERSION HISTORY -->
<div class="vh-outer">
  <div class="vh-bar" onclick="toggleVH()">
    <span class="vh-title">Version History <span id="vh-count" style="color:var(--dim);font-weight:300;text-transform:none;letter-spacing:.05em;"></span></span>
    <span class="vh-toggle" id="vh-toggle">â–¾</span>
  </div>
  <div class="vh-list" id="vh-list">
    <p class="vh-empty" id="vh-empty">No saved versions yet. Click âœ Edit â†’ â†‘ Save Version to start.</p>
  </div>
</div>

<!-- RESTORE MODAL -->
<div class="restore-modal" id="restore-modal">
  <div class="restore-box">
    <div class="restore-header">
      <span class="restore-title">Restore this version?</span>
      <button class="restore-close" onclick="closeRestoreModal()">âœ•</button>
    </div>
    <div class="restore-preview" id="restore-preview"></div>
    <div class="restore-actions">
      <button class="editor-btn" onclick="closeRestoreModal()">Cancel</button>
      <button class="editor-btn primary" onclick="confirmRestore()">Restore</button>
    </div>
  </div>
</div>

<!-- POST NAV -->
<div class="post-nav-outer">
  <a class="post-nav-btn left" href="social-post-01.html"><span class="nav-arrow">â€¹</span><div><span class="nav-meta">Previous</span><span class="nav-name">Post 01</span></div></a>
  <div style="font-size:11px;font-weight:600;letter-spacing:.4em;color:var(--muted);text-transform:uppercase;padding-top:16px;">Post 2 of 2</div>
  <div></div>
</div>

<!-- FAB -->
<div class="fab">
  <div class="fab-label">Review Decision</div>
  <div class="fab-comment-box" id="fab-comment-box">
    <textarea class="fab-textarea" id="fab-textarea" placeholder="Add a note (optional)â€¦"></textarea>
    <button class="fab-save-comment" onclick="fabSaveNote(2)">Save Note</button>
  </div>
  <div class="fab-buttons">
    <button class="fab-btn approve" data-action="approved" onclick="fabAction(2,'approved')">âœ“ Approve</button>
    <button class="fab-btn needs"   data-action="needs"    onclick="fabAction(2,'needs')">âš  Changes</button>
    <button class="fab-btn reject"  data-action="rejected"  onclick="fabAction(2,'rejected')">âœ• Reject</button>
    <button class="fab-comment-toggle" onclick="toggleCommentBox()">âœ Note</button>
  </div>
</div>

<!-- Firebase + scripts -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script src="social-app.js"></script>
<script src="social-posts-data.js"></script>
<script>
const POST_ID = 2;

// Keep both name inputs in sync
['commenter-name','comment-name-sync'].forEach(id => {
  document.getElementById(id)?.addEventListener('input', function() {
    ['commenter-name','comment-name-sync'].forEach(other => {
      if (other !== id) { const el = document.getElementById(other); if(el) el.value = this.value; }
    });
  });
});

// submitComment wrapper that reads from either name input
function submitCommentLocal(postId) {
  const name = (document.getElementById('commenter-name')?.value || '').trim();
  const syncEl = document.getElementById('comment-name-sync');
  if (syncEl && name) syncEl.value = name;
  submitComment(postId);
}

// Char counts
function updateCharCount(el, id, max) {
  const countEl = document.getElementById(id);
  if (!countEl) return;
  const len = el.value.length;
  countEl.textContent = len.toLocaleString()+' / '+max.toLocaleString();
  countEl.className = 'char-count'+(len>max?' over':len>max*.9?' warn':'');
}
function updateHashCount(el, id) {
  const countEl = document.getElementById(id);
  if (!countEl) return;
  const tags = el.value.split(/[\s,]+/).filter(Boolean);
  countEl.textContent = tags.length+' / 30 tags';
  countEl.className = 'char-count'+(tags.length>30?' over':tags.length>27?' warn':'');
}

// Keep date display in header in sync
function syncDateDisplay() {
  const date = document.getElementById('field-postDate')?.value || '';
  const time = document.getElementById('field-postTime')?.value || '';
  const disp = document.getElementById('date-display');
  if (!disp) return;
  let ts = '';
  if (time) {
    const [h,m] = time.split(':'); const hr=parseInt(h);
    ts = ' at '+(hr%12||12)+':'+m+(hr>=12?' PM':' AM')+' CT';
  }
  disp.textContent = (date||'TBD') + ts;
}

// Live connection indicator
setTimeout(() => {
  if (typeof firebase !== 'undefined' && firebase.apps.length) {
    firebase.database().ref('.info/connected').on('value', snap => {
      const connected = snap.val();
      ['live-indicator','disc-live'].forEach(id => {
        const el = document.getElementById(id);
        if (!el) return;
        el.textContent = connected ? 'Live' : 'Offline';
        el.className = 'live-dot ' + (connected ? 'connected' : 'offline');
      });
    });
  }
}, 400);

emailjs.init(CONFIG.emailjsPublicKey);
initFirebase();
initPostPage(POST_ID);
loadComments(POST_ID);
loadVersionHistory(POST_ID);
</script>
</body>
</html>